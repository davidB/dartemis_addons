// Auto-generated from xcolorselector.html.
// DO NOT EDIT.

library x_colorselector;

import 'dart:html' as autogenerated;
import 'dart:svg' as autogenerated_svg;
import 'package:web_ui/web_ui.dart' as autogenerated;
import 'package:web_ui/observe/observable.dart' as __observe;
import 'dart:html';
import 'dart:math' as math;
import 'package:web_ui/web_ui.dart';
import 'package:dartemis_toolbox/colors.dart';



/// the main goal of the component is to show feature of colors .
class XColorselector extends WebComponent{
  /** Autogenerated from the template. */

  /** CSS class constants. */
  static Map<String, String> _css = {".cs_sampletxt":"cs_sampletxt",".cs_sv":"cs_sv",".cs_h":"cs_h",".cs_samplebox":"cs_samplebox"};

  /** This field is deprecated, use getShadowRoot instead. */
  get _root => getShadowRoot("x-colorselector");
  static final __html1 = new autogenerated.BRElement(), __html10 = new autogenerated.BRElement(), __html11 = new autogenerated.Element.html('<span class="cs_sampletxt"></span>'), __html12 = new autogenerated.Element.html('<span class="cs_samplebox" style="background-color:{{irgba_hexHtml(c)}}"></span>'), __html13 = new autogenerated.BRElement(), __html14 = new autogenerated.Element.html('<span class="cs_sampletxt"></span>'), __html15 = new autogenerated.Element.html('<span class="cs_samplebox" style="background-color:{{irgba_hexHtml(c)}}"></span>'), __html2 = new autogenerated.Element.html('<span class="cs_sampletxt"></span>'), __html3 = new autogenerated.Element.html('<span class="cs_samplebox" style="background-color:{{irgba_hexHtml(c)}}"></span>'), __html4 = new autogenerated.BRElement(), __html5 = new autogenerated.Element.html('<span class="cs_sampletxt"></span>'), __html6 = new autogenerated.Element.html('<span class="cs_samplebox" style="background-color:{{irgba_hexHtml(c)}}"></span>'), __html7 = new autogenerated.BRElement(), __html8 = new autogenerated.Element.html('<span class="cs_sampletxt"></span>'), __html9 = new autogenerated.Element.html('<span class="cs_samplebox" style="background-color:{{irgba_hexHtml(c)}}"></span>'), __shadowTemplate = new autogenerated.DocumentFragment.html('''
        <style>
.cs_h, .cs_sv {
  cursor: pointer;
}
.cs_samplebox {
  width: 3em;
  height: 1em;
  border: 1px solid;
  display: inline-block;
  cursor: pointer;
}
.cs_sampletxt {
  height: 1em;
  width: 5em;
  display: inline-block;
}
</style><div class="container-fluid">
          <div class="span3">
            <canvas class="cs_sv" width="104" height="104"></canvas>
            <canvas class="cs_h" width="14" height="104"></canvas>
          </div>
          <fieldset class="span3">
            <legend>RGB</legend>
            <div><label></label><input type="range" min="0" max="255" step="1"></div>
            <div><label></label><input type="range" min="0" max="255" step="1"></div>
            <div><label></label><input type="range" min="0" max="255" step="1"></div>
            <div><label>html : </label><input type="text"></div>
            <div><label>irgba : </label><input type="text"></div>
          </fieldset>
          <fieldset class="span3">
            <legend>HSV</legend>
            <div><label></label><input type="range" min="0" max="360" step="1"></div>
            <div><label></label><input type="range" min="0" max="100" step="1"></div>
            <div><label></label><input type="range" min="0" max="100" step="1"></div>
          </fieldset>
          <fieldset class="span3">
            <legend>Modifier</legend>
            <div>
             <button class="btn">complement</button>
             <button class="btn">greyscale</button>
            </div>
            <div>
              <button class="btn">lighten 10%</button>
              <button class="btn">darken 10%</button>
            </div>
            <div>
              <button class="btn">saturate 10%</button>
              <button class="btn">desaturate 10%</button>
            </div>
            <div>
              <button class="btn">random</button>
            </div>
          </fieldset>
          <fieldset class="span3">
            <legend>triad</legend>
            <div></div>
          </fieldset>
          <fieldset class="span3">
            <legend>tetrad</legend>
            <div></div>
          </fieldset>
          <fieldset class="span3">
            <legend>split complement</legend>
            <div></div>
          </fieldset>
          <fieldset class="span3">
            <legend>analogous</legend>
            <div></div>
          </fieldset>
          <fieldset class="span3">
            <legend>monochromatic</legend>
            <div></div>
          </fieldset>
        </div>
      ''');
  autogenerated.ButtonElement __e23, __e24, __e25, __e26, __e27, __e28, __e29;
  autogenerated.CanvasElement __e1, __e2;
  autogenerated.DivElement __e33, __e37, __e41, __e45, __e49;
  autogenerated.InputElement __e11, __e12, __e13, __e16, __e19, __e22, __e5, __e8;
  autogenerated.LabelElement __e10, __e15, __e18, __e21, __e4, __e7;
  autogenerated.Template __t;

  void created_autogenerated() {
    var __root = createShadowRoot("x-colorselector");
    __t = new autogenerated.Template(__root);
    __root.nodes.add(__shadowTemplate.clone(true));
    __e1 = __root.nodes[2].nodes[1].nodes[1];
    __t.listen(__e1.onClick, ($event) { sv_setColorFromEvt($event); });
    __e2 = __root.nodes[2].nodes[1].nodes[3];
    __t.listen(__e2.onClick, ($event) { h_setColorFromEvt($event); });
    __e4 = __root.nodes[2].nodes[3].nodes[3].nodes[0];
    var __binding3 = __t.contentBind(() => rStr, false);
    __e4.nodes.addAll([new autogenerated.Text('R : '),
        __binding3]);
    __e5 = __root.nodes[2].nodes[3].nodes[3].nodes[1];
    __t.listen(__e5.onInput, ($event) { rStr = __e5.value; });
    __t.oneWayBind(() => rStr, (e) { if (__e5.value != e) __e5.value = e; }, false, false);
    __e7 = __root.nodes[2].nodes[3].nodes[5].nodes[0];
    var __binding6 = __t.contentBind(() => gStr, false);
    __e7.nodes.addAll([new autogenerated.Text('G : '),
        __binding6]);
    __e8 = __root.nodes[2].nodes[3].nodes[5].nodes[1];
    __t.listen(__e8.onInput, ($event) { gStr = __e8.value; });
    __t.oneWayBind(() => gStr, (e) { if (__e8.value != e) __e8.value = e; }, false, false);
    __e10 = __root.nodes[2].nodes[3].nodes[7].nodes[0];
    var __binding9 = __t.contentBind(() => bStr, false);
    __e10.nodes.addAll([new autogenerated.Text('B : '),
        __binding9]);
    __e11 = __root.nodes[2].nodes[3].nodes[7].nodes[1];
    __t.listen(__e11.onInput, ($event) { bStr = __e11.value; });
    __t.oneWayBind(() => bStr, (e) { if (__e11.value != e) __e11.value = e; }, false, false);
    __e12 = __root.nodes[2].nodes[3].nodes[9].nodes[1];
    __t.listen(__e12.onInput, ($event) { hex_html = __e12.value; });
    __t.oneWayBind(() => hex_html, (e) { if (__e12.value != e) __e12.value = e; }, false, false);
    __e13 = __root.nodes[2].nodes[3].nodes[11].nodes[1];
    __t.listen(__e13.onInput, ($event) { hex_irgba = __e13.value; });
    __t.oneWayBind(() => hex_irgba, (e) { if (__e13.value != e) __e13.value = e; }, false, false);
    __e15 = __root.nodes[2].nodes[5].nodes[3].nodes[0];
    var __binding14 = __t.contentBind(() => hStr, false);
    __e15.nodes.addAll([new autogenerated.Text('H : '),
        __binding14,
        new autogenerated.Text('Â°')]);
    __e16 = __root.nodes[2].nodes[5].nodes[3].nodes[1];
    __t.listen(__e16.onInput, ($event) { hStr = __e16.value; });
    __t.oneWayBind(() => hStr, (e) { if (__e16.value != e) __e16.value = e; }, false, false);
    __e18 = __root.nodes[2].nodes[5].nodes[5].nodes[0];
    var __binding17 = __t.contentBind(() => sStr, false);
    __e18.nodes.addAll([new autogenerated.Text('S : '),
        __binding17,
        new autogenerated.Text('%')]);
    __e19 = __root.nodes[2].nodes[5].nodes[5].nodes[1];
    __t.listen(__e19.onInput, ($event) { sStr = __e19.value; });
    __t.oneWayBind(() => sStr, (e) { if (__e19.value != e) __e19.value = e; }, false, false);
    __e21 = __root.nodes[2].nodes[5].nodes[7].nodes[0];
    var __binding20 = __t.contentBind(() => vStr, false);
    __e21.nodes.addAll([new autogenerated.Text('V : '),
        __binding20,
        new autogenerated.Text('%')]);
    __e22 = __root.nodes[2].nodes[5].nodes[7].nodes[1];
    __t.listen(__e22.onInput, ($event) { vStr = __e22.value; });
    __t.oneWayBind(() => vStr, (e) { if (__e22.value != e) __e22.value = e; }, false, false);
    __e23 = __root.nodes[2].nodes[7].nodes[3].nodes[1];
    __t.listen(__e23.onClick, ($event) { complement(); });
    __e24 = __root.nodes[2].nodes[7].nodes[3].nodes[3];
    __t.listen(__e24.onClick, ($event) { greyscale(); });
    __e25 = __root.nodes[2].nodes[7].nodes[5].nodes[1];
    __t.listen(__e25.onClick, ($event) { lighten(); });
    __e26 = __root.nodes[2].nodes[7].nodes[5].nodes[3];
    __t.listen(__e26.onClick, ($event) { darken(); });
    __e27 = __root.nodes[2].nodes[7].nodes[7].nodes[1];
    __t.listen(__e27.onClick, ($event) { saturate(); });
    __e28 = __root.nodes[2].nodes[7].nodes[7].nodes[3];
    __t.listen(__e28.onClick, ($event) { desaturate(); });
    __e29 = __root.nodes[2].nodes[7].nodes[9].nodes[1];
    __t.listen(__e29.onClick, ($event) { random(); });
    __e33 = __root.nodes[2].nodes[9].nodes[3];
    __t.loopIterateAttr(__e33, () => triad, ($list, $index, __t) {
      var c = $list[$index];
      var __e31, __e32;
      __e31 = __html2.clone(true);
      var __binding30 = __t.contentBind(() => irgba_hexString(c), false);
      __e31.nodes.add(__binding30);
      __e32 = __html3.clone(true);
      __t.listen(__e32.onClick, ($event) { color = c; });
      __t.bind(() => irgba_hexHtml(c),  (__e) { __e32.attributes['style'] = 'background-color:${__e.newValue}'; }, false);
    __t.addAll([new autogenerated.Text('\n              '),
        __e31,
        new autogenerated.Text('\n              '),
        __e32,
        new autogenerated.Text('\n              '),
        __html1.clone(true),
        new autogenerated.Text('\n            ')]);
    });
    __e37 = __root.nodes[2].nodes[11].nodes[3];
    __t.loopIterateAttr(__e37, () => tetrad, ($list, $index, __t) {
      var c = $list[$index];
      var __e35, __e36;
      __e35 = __html5.clone(true);
      var __binding34 = __t.contentBind(() => irgba_hexString(c), false);
      __e35.nodes.add(__binding34);
      __e36 = __html6.clone(true);
      __t.listen(__e36.onClick, ($event) { color = c; });
      __t.bind(() => irgba_hexHtml(c),  (__e) { __e36.attributes['style'] = 'background-color:${__e.newValue}'; }, false);
    __t.addAll([new autogenerated.Text('\n              '),
        __e35,
        new autogenerated.Text('\n              '),
        __e36,
        new autogenerated.Text('\n              '),
        __html4.clone(true),
        new autogenerated.Text('\n            ')]);
    });
    __e41 = __root.nodes[2].nodes[13].nodes[3];
    __t.loopIterateAttr(__e41, () => splitcomplement, ($list, $index, __t) {
      var c = $list[$index];
      var __e39, __e40;
      __e39 = __html8.clone(true);
      var __binding38 = __t.contentBind(() => irgba_hexString(c), false);
      __e39.nodes.add(__binding38);
      __e40 = __html9.clone(true);
      __t.listen(__e40.onClick, ($event) { color = c; });
      __t.bind(() => irgba_hexHtml(c),  (__e) { __e40.attributes['style'] = 'background-color:${__e.newValue}'; }, false);
    __t.addAll([new autogenerated.Text('\n              '),
        __e39,
        new autogenerated.Text('\n              '),
        __e40,
        new autogenerated.Text('\n              '),
        __html7.clone(true),
        new autogenerated.Text('\n            ')]);
    });
    __e45 = __root.nodes[2].nodes[15].nodes[3];
    __t.loopIterateAttr(__e45, () => analogous, ($list, $index, __t) {
      var c = $list[$index];
      var __e43, __e44;
      __e43 = __html11.clone(true);
      var __binding42 = __t.contentBind(() => irgba_hexString(c), false);
      __e43.nodes.add(__binding42);
      __e44 = __html12.clone(true);
      __t.listen(__e44.onClick, ($event) { color = c; });
      __t.bind(() => irgba_hexHtml(c),  (__e) { __e44.attributes['style'] = 'background-color:${__e.newValue}'; }, false);
    __t.addAll([new autogenerated.Text('\n              '),
        __e43,
        new autogenerated.Text('\n              '),
        __e44,
        new autogenerated.Text('\n              '),
        __html10.clone(true),
        new autogenerated.Text('\n            ')]);
    });
    __e49 = __root.nodes[2].nodes[17].nodes[3];
    __t.loopIterateAttr(__e49, () => monochromatic, ($list, $index, __t) {
      var c = $list[$index];
      var __e47, __e48;
      __e47 = __html14.clone(true);
      var __binding46 = __t.contentBind(() => irgba_hexString(c), false);
      __e47.nodes.add(__binding46);
      __e48 = __html15.clone(true);
      __t.listen(__e48.onClick, ($event) { color = c; });
      __t.bind(() => irgba_hexHtml(c),  (__e) { __e48.attributes['style'] = 'background-color:${__e.newValue}'; }, false);
    __t.addAll([new autogenerated.Text('\n              '),
        __e47,
        new autogenerated.Text('\n              '),
        __e48,
        new autogenerated.Text('\n              '),
        __html13.clone(true),
        new autogenerated.Text('\n            ')]);
    });
    __t.create();
  }

  void inserted_autogenerated() {
    __t.insert();
  }

  void removed_autogenerated() {
    __t.remove();
    __t = __e1 = __e2 = __e4 = __e5 = __e7 = __e8 = __e10 = __e11 = __e12 = __e13 = __e15 = __e16 = __e18 = __e19 = __e21 = __e22 = __e23 = __e24 = __e25 = __e26 = __e27 = __e28 = __e29 = __e33 = __e37 = __e41 = __e45 = __e49 = null;
  }

  /** Original code from the component. */


  int _color = 0xaaaaaaff;

  @observable
  get color => _color;
  @observable
  set color(v){
    _color = v;
    refresh();
  }

  @observable
  get hex_html => irgba_hexHtml(color);
  @observable
  set hex_html(s){
    color = hexHtml_irgba(s);
  }

  @observable
  get hex_irgba => irgba_hexString(color);
  @observable
  set hex_irgba(s){
    color = hexString_irgba(s);
  }

  @observable
  get rStr => irgba_r255(color).toString();
  @observable
  set rStr(s) {
    if (s == null || s.length < 1) s = "0";
    color = irgba_r255_set(color, int.parse(s, radix : 10));
  }

  @observable
  get gStr => irgba_g255(color).toString();
  @observable
  set gStr(s) {
    if (s == null || s.length < 1) s = "0";
    color = irgba_g255_set(color, int.parse(s, radix : 10));
  }

  @observable
  get bStr => irgba_b255(color).toString();
  @observable
  set bStr(s) {
    if (s == null || s.length < 1) s = "0";
    color = irgba_b255_set(color, int.parse(s, radix : 10));
  }

  @observable
  get hStr => (irgba_hsv(color)[0] * 360).toInt().toString();
  @observable
  set hStr(s) {
    if (s == null || s.length < 1) s = "0";
    var hsv = irgba_hsv(color);
    hsv[0] = int.parse(s, radix : 10) / 360.0;
    color = hsv_irgba(hsv);
  }

  @observable
  get sStr => (irgba_hsv(color)[1] * 100).toInt().toString();
  @observable
  set sStr(s) {
    if (s == null || s.length < 1) s = "0";
    var hsv = irgba_hsv(color);
    hsv[1] = int.parse(s, radix : 10) / 100.0;
    color = hsv_irgba(hsv);
  }

  @observable
  get vStr => (irgba_hsv(color)[2] * 100).toInt().toString();
  @observable
  set vStr(s) {
    if (s == null || s.length < 1) s = "0";
    var hsv = irgba_hsv(color);
    hsv[2] = int.parse(s, radix : 10) / 100.0;
    color = hsv_irgba(hsv);
  }

  @observable
  get triad => hsl_triad(irgba_hsl(color)).map(hsl_irgba);

  @observable
  get tetrad => hsl_tetrad(irgba_hsl(color)).map(hsl_irgba);

  @observable
  get splitcomplement => hsl_splitcomplement(irgba_hsl(color)).map(hsl_irgba);

  @observable
  get analogous => hsl_analogous(irgba_hsl(color)).map(hsl_irgba);

  @observable
  get monochromatic => hsv_monochromatic(irgba_hsv(color)).map(hsv_irgba);

//  irgba_hex(List<double> hsl) => irgba_hexString(hsl_irgba(hsl));
//  irgba_html() => irgba_hexHtml(irgba(hsl));

  complement() {
    color = hsl_irgba(hsl_complement(irgba_hsl(color)));
  }

  saturate() {
    color = hsl_irgba(hsl_saturate(irgba_hsl(color)));
  }

  desaturate() {
    color = hsl_irgba(hsl_desaturate(irgba_hsl(color)));
  }

  greyscale() {
    color = hsl_irgba(hsl_greyscale(irgba_hsl(color)));
  }

  lighten() {
    color = hsl_irgba(hsl_lighten(irgba_hsl(color)));
  }

  darken() {
    color = hsl_irgba(hsl_darken(irgba_hsl(color)));
  }

  random() {
    color = random_irgba();
  }
  /// An common optimisation is to use a color + bacground image with alpha
  /// like done by yui-color-picker [sample](http://www.colorspire.com/s/j/yui282/asset/picker_mask.png)
  sv_draw() {
    var c = this.query('canvas.cs_sv') as CanvasElement;
    var g = c.context2d;
    var sel = 2;
    var w1 = (c.width - 2 * sel)/ 100.0;
    var h1 = (c.height - 2 * sel)/ 100.0;
    var hsv = irgba_hsv(color);
    g.clearRect(0,0, c.width, c.height);
    for(var s0 = 0; s0 < 101; ++s0) {
      for(var v0 = 0; v0 < 101; ++v0) {
        g.fillStyle = irgba_hexHtml(hsv_irgba([hsv[0], s0/100, v0/100]));
        g.fillRect((100 - s0) * w1 + sel, (100 - v0) * h1 + sel, w1, h1);
      }
    }
    g.beginPath();
    g.arc((100 - hsv[1] * 100) * w1 + sel, (100 - hsv[2] * 100) * h1 + sel, sel + math.max(h1, w1), 0, 2 * math.PI);
    g.closePath();
    g.strokeStyle = '#000000';
    g.stroke();
  }

  sv_setColorFromEvt(MouseEvent evt){
    var t =  evt.target as CanvasElement;
    sv_setColorFrom(evt.offsetX, evt.offsetY, t.width, t.height);
    return true;
  }

  sv_setColorFrom(x, y, width, height) {
    var sel = 2;
    var w1 = (width - 2 * sel)/ 100.0;
    var h1 = (height - 2 * sel)/ 100.0;

    var hsv = irgba_hsv(color);
    hsv[1] = (100 - x - sel) / (w1*100.0);
    hsv[2] = (100 - y - sel) / (h1*100.0);
    color = hsv_irgba(hsv);
  }

  /// An common optimisation is to use a image for the hue bar
  h_draw() {
    var c = this.query('canvas.cs_h') as CanvasElement;
    var g = c.context2d;
    var sel = 2;
    var w1 = c.width - (2 * sel);
    var h1 = (c.height - (2 * sel))/ 100.0;
    var h0 = irgba_hsv(color)[0];
    g.clearRect(0,0, c.width, c.height);
    for(var y = 0; y < 101; ++y) {
      var s = irgba_hexHtml(hsv_irgba([y/100.0, 1.0, 1.0]));
      //var s = 'rgb(${(y*255/100).toInt()}, 0, 0)';
      g.fillStyle = s;
      g.fillRect(sel, (y * h1) + sel, w1, h1);
    }
    g.strokeStyle = '#000000';
    g.strokeRect(0, (h0 * 100 * h1) + sel, w1 + 2 * sel, h1 + 2 * sel);
  }

  h_setColorFromEvt(MouseEvent evt){
    var t =  evt.target as CanvasElement;
    h_setColorFrom(evt.offsetX, evt.offsetY, t.width, t.height);
    return true;
  }

  h_setColorFrom(x, y, width, height) {
    var h1 = (height - (2 * 2))/ 100.0;
    var hsv = irgba_hsv(color);
    hsv[0] = (y - 2) / (h1*100.0);
    color = hsv_irgba(hsv);
  }

  void inserted() {
    color = random_irgba();
    refresh();
  }

  void refresh() {
    sv_draw();
    h_draw();
  }
}

//@ sourceMappingURL=xcolorselector.dart.map