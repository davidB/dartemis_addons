        <!DOCTYPE html>
        <html>
        <head>
                <meta charset="utf-8">
        <title>system_emitter Library / Dart Documentation</title>
        <link rel="stylesheet" type="text/css"
            href="styles.css">
        <link href="//fonts.googleapis.com/css?family=Open+Sans:400,600,700,800" rel="stylesheet" type="text/css">
        <link rel="shortcut icon" href="favicon.ico">
        
        </head>
        <body data-library="system_emitter">
        <div class="page">
        <div class="header">
          <a href="index.html"><div class="logo"></div></a>
          <a href="index.html">Dart Documentation</a>
         &rsaquo; <a href="system_emitter.html">system_emitter</a>        <div id="search-box">
          <input type="search" name="q" id="q" autocomplete="off"
              class="search-input" placeholder="Search API">
        </div>
        
      </div>
      <div class="drop-down" id="drop-down"></div>
      
        <div class="nav">
        
</div>
<div class="content">
<h2><strong>system_emitter</strong> library</h2>
<div class="doc"><p>TODO lot of test (unit, ...)
TODO benchmark, profiling, optimisation</p></div>
<div>
<h3>Properties</h3>
<div class="field"><h4 id="VX_AXIS">
<button class="show-code">Code</button>
final         <strong>VX_AXIS</strong> <a class="anchor-link"
            href="#VX_AXIS"
            title="Permalink to VX_AXIS">#</a>
        </h4>
        <div class="doc">
<pre class="source">
final VX_AXIS = new vec3(1.0, 1.0, 0.0)
</pre>
</div>
</div>
<div class="field"><h4 id="VY_AXIS">
<button class="show-code">Code</button>
final         <strong>VY_AXIS</strong> <a class="anchor-link"
            href="#VY_AXIS"
            title="Permalink to VY_AXIS">#</a>
        </h4>
        <div class="doc">
<pre class="source">
final VY_AXIS = new vec3(0.0, 1.0, 0.0)
</pre>
</div>
</div>
<div class="field"><h4 id="VZERO">
<button class="show-code">Code</button>
final         <strong>VZERO</strong> <a class="anchor-link"
            href="#VZERO"
            title="Permalink to VZERO">#</a>
        </h4>
        <div class="doc">
<pre class="source">
final VZERO = new vec3.zero()
</pre>
</div>
</div>
</div>
<div>
<h3>Functions</h3>
<div class="method"><h4 id="cone">
<button class="show-code">Code</button>
<a href="system_emitter/Vec3GenInto.html">Vec3GenInto</a> <strong>cone</strong>({vec3 apex, vec3 axis, <a href="http://api.dartlang.org/dart_core/double.html">double</a> angle: 0.0, <a href="http://api.dartlang.org/dart_core/double.html">double</a> height: 10.0, <a href="http://api.dartlang.org/dart_core/double.html">double</a> truncatedHeight: 0.0}) <a class="anchor-link" href="#cone"
              title="Permalink to cone">#</a></h4>
<div class="doc">
<pre class="source">
Vec3GenInto cone({vec3 apex, vec3 axis, double angle : 0.0, double height : 10.0, double truncatedHeight : 0.0} ){
 apex = (apex == null) ? new vec3() : apex;
 axis = (axis  == null)?  VY_AXIS : axis;
 var _perp1 = perpendicular(axis);
 var _perp2 = axis.cross( _perp1 ).normalize();
 return (v, dt){
   var h = _random.nextDouble();
   h = truncatedHeight + ( 1 - h * h ) * ( height - truncatedHeight );

   var r = _random.nextDouble();
   var radiusAtHeight = math.tan( angle / 2 ) * h;
   r = ( 1 - r * r ) * ( h ) * radiusAtHeight;

   var a = _random.nextDouble() * 2 * math.PI;
   var p1 = _perp1.clone();
   p1.scale( r * math.cos( a ) );
   var p2  = _perp2.clone();
   p2.scale( r * math.sin( a ) );
   return v.setFrom(axis)
     .scale( h )
     .add(p1)
     .add(p2)
     .add(apex)
     ;
 };
}
</pre>
</div>
</div>
<div class="method"><h4 id="perpendicular">
<button class="show-code">Code</button>
vec3 <strong>perpendicular</strong>(vec3 v) <a class="anchor-link" href="#perpendicular"
              title="Permalink to perpendicular">#</a></h4>
<div class="doc">
<pre class="source">
vec3 perpendicular(vec3 v) {
 if( v.x == 0 ) {
   return new vec3( 1.0, 0.0, 0.0 );
 } else {
   return new vec3( v.y, -v.x, 0 ).normalize();
 }
}
</pre>
</div>
</div>
<div class="method"><h4 id="line">
<button class="show-code">Code</button>
<a href="system_emitter/Vec3GenInto.html">Vec3GenInto</a> <strong>line</strong>(vec3 start, vec3 end, <a href="ease/Ease.html">Ease</a> easing) <a class="anchor-link" href="#line"
              title="Permalink to line">#</a></h4>
<div class="doc">
<pre class="source">
Vec3GenInto line(vec3 start, vec3 end, ease.Ease easing){
 var length = end - start;
 var acc = 0.0;
 return (v, dt){
   v.setFrom(length).scale(easing(acc, 1.0, 0)).add(start);
   acc += dt;
   return v;
 };
}
</pre>
</div>
</div>
<div class="method"><h4 id="box">
<button class="show-code">Code</button>
<a href="system_emitter/Vec3GenInto.html">Vec3GenInto</a> <strong>box</strong>(vec3 center, vec3 offsets) <a class="anchor-link" href="#box"
              title="Permalink to box">#</a></h4>
<div class="doc">
<pre class="source">
Vec3GenInto box(vec3 center, vec3 offsets) =&gt; (v, dt){
 v.setFrom(center);
 v.x += (_random.nextDouble() - 0.5) * 2 * offsets.x;
 v.y += (_random.nextDouble() - 0.5) * 2 * offsets.y;
 v.z += (_random.nextDouble() - 0.5) * 2 * offsets.z;
 return v;
};
</pre>
</div>
</div>
<div class="method"><h4 id="constant">
<button class="show-code">Code</button>
<a href="system_emitter/Vec3GenInto.html">Vec3GenInto</a> <strong>constant</strong>(vec3 x) <a class="anchor-link" href="#constant"
              title="Permalink to constant">#</a></h4>
<div class="doc">
<p>always return a clone of x.</p>
<pre class="source">
Vec3GenInto constant(vec3 x) =&gt; (v, dt) =&gt; v.setFrom(x);
</pre>
</div>
</div>
<div class="method"><h4 id="easingOverTime">
<button class="show-code">Code</button>
<a href="system_emitter/IntGen.html">IntGen</a> <strong>easingOverTime</strong>(<a href="ease/Ease.html">Ease</a> easing, <a href="http://api.dartlang.org/dart_core/num.html">num</a> change, <a href="http://api.dartlang.org/dart_core/num.html">num</a> baseValue) <a class="anchor-link" href="#easingOverTime"
              title="Permalink to easingOverTime">#</a></h4>
<div class="doc">
<pre class="source">
IntGen easingOverTime(ease.Ease easing, num change, num baseValue){
 num _acc = 0.0;
 return (dt){
   _acc += dt;
   return easing(_acc, change, baseValue).toInt();
 };
}
</pre>
</div>
</div>
<div class="method"><h4 id="steady">
<button class="show-code">Code</button>
<a href="system_emitter/IntGen.html">IntGen</a> <strong>steady</strong>(<a href="http://api.dartlang.org/dart_core/int.html">int</a> rate) <a class="anchor-link" href="#steady"
              title="Permalink to steady">#</a></h4>
<div class="doc">
<p>
<span class="param">rate</span> The number of particles to emit per second.
TODO manage case where rate * dt &lt; 1000</p>
<pre class="source">
IntGen steady(int rate) {
 num _acc = 0;
 num _rateInv = (rate &gt; 0)? 1000/rate : 0;
 return (dt){
   _acc += dt;
   var b = ((rate * _acc) / 1000).round();
   //print("${b * 1000/_acc} ---- ${b} --- ${_acc}");
   _acc -= b * _rateInv;
   return b;
 };
}
</pre>
</div>
</div>
<div class="method"><h4 id="singleWave">
<button class="show-code">Code</button>
<a href="system_emitter/IntGen.html">IntGen</a> <strong>singleWave</strong>(v) <a class="anchor-link" href="#singleWave"
              title="Permalink to singleWave">#</a></h4>
<div class="doc">
<pre class="source">
IntGen singleWave(v) =&gt; ((dt) =&gt; (dt == 0) ? v : 0);
</pre>
</div>
</div>
<div class="method"><h4 id="zero">
<button class="show-code">Code</button>
<a href="system_emitter/IntGen.html">IntGen</a> <strong>zero</strong>() <a class="anchor-link" href="#zero"
              title="Permalink to zero">#</a></h4>
<div class="doc">
<p>always return 0.</p>
<pre class="source">
IntGen zero() =&gt; (dt) =&gt; 0;
</pre>
</div>
</div>
<div class="method"><h4 id="particlesAddComponents">
<button class="show-code">Code</button>
<a href="system_emitter/Initializer.html">Initializer</a> <strong>particlesAddComponents</strong>(<a href="http://api.dartlang.org/dart_core/List.html">List</a>&lt;<a href="http://api.dartlang.org/dart_core/Function.html">Function</a>&gt; fs) <a class="anchor-link" href="#particlesAddComponents"
              title="Permalink to particlesAddComponents">#</a></h4>
<div class="doc">
<pre class="source">
Initializer particlesAddComponents(List&lt;Function&gt; fs) =&gt; (dt, Entity emitter, List&lt;Entity&gt; es) {
 es.forEach((e){
   var ps = e.getComponent(Particles.CT) as Particles;
   if (ps != null) {
     fs.forEach((f) =&gt; e.addComponent(f(ps.l.length)));
   }
 });
};
</pre>
</div>
</div>
<div class="method"><h4 id="addComponents">
<button class="show-code">Code</button>
<a href="system_emitter/Initializer.html">Initializer</a> <strong>addComponents</strong>(<a href="http://api.dartlang.org/dart_core/List.html">List</a>&lt;<a href="http://api.dartlang.org/dart_core/Function.html">Function</a>&gt; fs) <a class="anchor-link" href="#addComponents"
              title="Permalink to addComponents">#</a></h4>
<div class="doc">
<pre class="source">
Initializer addComponents(List&lt;Function&gt; fs) =&gt; (dt, Entity emitter, List&lt;Entity&gt; es) {
 es.forEach((e){
   fs.forEach((f) =&gt; e.addComponent(f()));
 });
};
</pre>
</div>
</div>
<div class="method"><h4 id="addParticleInfo0s">
<button class="show-code">Code</button>
<a href="system_emitter/Initializer.html">Initializer</a> <strong>addParticleInfo0s</strong>() <a class="anchor-link" href="#addParticleInfo0s"
              title="Permalink to addParticleInfo0s">#</a></h4>
<div class="doc">
<pre class="source">
Initializer addParticleInfo0s() =&gt; particlesAddComponents([
 (lg) =&gt; new ParticleInfo0s(lg)
]);
</pre>
</div>
</div>
<div class="method"><h4 id="particlesStartPositionPrevious">
<button class="show-code">Code</button>
<a href="system_emitter/Initializer.html">Initializer</a> <strong>particlesStartPositionPrevious</strong>(<a href="system_emitter/Vec3GenInto.html">Vec3GenInto</a> gen, <a href="http://api.dartlang.org/dart_core/bool.html">bool</a> fromEmitter) <a class="anchor-link" href="#particlesStartPositionPrevious"
              title="Permalink to particlesStartPositionPrevious">#</a></h4>
<div class="doc">
<p>used to define a initial velocity if Verlet Simulator, also add Constraints Component
should add after a Initializer that set position3d of particules</p>
<pre class="source">
Initializer particlesStartPositionPrevious(Vec3GenInto gen, bool fromEmitter) =&gt; (dt, Entity emitter, List&lt;Entity&gt; es) {
 var mat4 = new mat4.identity();
 if (fromEmitter) {
   var tf = emitter.getComponent(Transform.CT) as Transform;
   mat4.rotateX(tf.rotation3d.x);
   mat4.rotateY(tf.rotation3d.y);
   mat4.rotateZ(tf.rotation3d.z);
 }
 processParticules(es, (p) {
    var v = gen(new vec3.zero(), dt);
    v = mat4.rotate3(v);
    v.add(p.position3d);
    p.position3dPrevious = v;
 });
};
</pre>
</div>
</div>
<div class="method"><h4 id="particlesStartPosition">
<button class="show-code">Code</button>
<a href="system_emitter/Initializer.html">Initializer</a> <strong>particlesStartPosition</strong>(<a href="system_emitter/Vec3GenInto.html">Vec3GenInto</a> gen, <a href="http://api.dartlang.org/dart_core/bool.html">bool</a> fromEmitter) <a class="anchor-link" href="#particlesStartPosition"
              title="Permalink to particlesStartPosition">#</a></h4>
<div class="doc">
<pre class="source">
Initializer particlesStartPosition(Vec3GenInto gen, bool fromEmitter) =&gt; (dt, Entity emitter, List&lt;Entity&gt; es) {
 var tf = emitter.getComponent(Transform.CT) as Transform;
 var pos = tf.position3d;
 processParticules(es, (p) {
   gen(p.position3d, dt);
   //print(p.position3d);
   if (fromEmitter) p.position3d.add(pos);
 });
};
</pre>
</div>
</div>
<div class="method"><h4 id="processParticules">
<button class="show-code">Code</button>
dynamic <strong>processParticules</strong>(<a href="http://api.dartlang.org/dart_core/List.html">List</a>&lt;Entity&gt; es, f(Particule)) <a class="anchor-link" href="#processParticules"
              title="Permalink to processParticules">#</a></h4>
<div class="doc">
<pre class="source">
processParticules(List&lt;Entity&gt; es, f(Particule)) {
 es.forEach((e) {
   var ps = e.getComponent(Particles.CT) as Particles;
   if (ps != null) {
     //print("init on ${ps.l.length} particles");
     ps.l.forEach(f);
   }
 });
}
</pre>
</div>
</div>
</div>
<div>
<h3>Classes</h3>
          <div class="type">
          <h4>
            <a href="system_emitter/Emitter.html"><strong>Emitter</strong></a>
          </h4>
          </div>
          
          <div class="type">
          <h4>
            <a href="system_emitter/System_Emitters.html"><strong>System_Emitters</strong></a>
          </h4>
          </div>
          
</div>
<div>
<h3>Typedefs</h3>
          <div class="type">
          <h4>
            <a href="system_emitter/Initializer.html"><strong>Initializer</strong></a>
          </h4>
          </div>
          
          <div class="type">
          <h4>
            <a href="system_emitter/IntGen.html"><strong>IntGen</strong></a>
          </h4>
          </div>
          
          <div class="type">
          <h4>
            <a href="system_emitter/Vec3GenInto.html"><strong>Vec3GenInto</strong></a>
          </h4>
          </div>
          
</div>
        </div>
        <div class="clear"></div>
        </div>
        <div class="footer">
          <div>This page was generated at 2013-05-20 21:46:56.660</div>
        </div>
        <script async src="client-live-nav.js"></script>
        </body></html>
        
